!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):t.WebApi=e()}(this,function(){"use strict";function t(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=void 0,i=_.defaultsDeep(t,{name:Math.round(1e3*Math.random()),title:"",width:document.documentElement.offsetWidth,height:document.documentElement.offsetHeight,titleHeight:60,draggable:!0,padding:{top:0,right:0,bottom:0,left:0},offset:{top:0,left:0},closeIconSize:20,borderRadius:8,background:"rgba(255,255,255,1)",backgroundImage:"rgba(255,255,255,1)",src:"",titleAlign:"center"});return u[i.name]&&console.error("已存在相同命名的弹框 "+i.name),e=new l({el:document.createElement("div"),propsData:i}),t.el&&(e.placeholder=document.createElement("div"),e.placeholder.id="placeholder-"+e._uid,t.el.parentNode.insertBefore(e.placeholder,t.el),e.$refs.contentElement.appendChild(t.el),t.el.style.display="block"),document.body.appendChild(e.$el),u[i.name]=e,new Promise(function(t,n){e.open().then(function(n){if(e.$el.parentNode.removeChild(e.$el),e.placeholder){var s=e.$refs.contentElement.children[0];s.style.display="none",e.placeholder.parentNode.insertBefore(s,e.placeholder),e.placeholder.parentNode.removeChild(e.placeholder)}e.$destroy(),delete u[i.name],t(n)})})}function e(t){t&&t.name?u[t.name].close(t.cmd||""):_.forEach(u,function(e,i){u[i].close(t||void 0)})}function i(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=void 0,i=_.defaultsDeep(_.isPlainObject(t)?t:{message:t},{name:Math.round(1e3*Math.random()),message:"",title:"消息",width:400,height:200,background:"white",titleHeight:60,bottomHeight:60,borderRadius:8});return e=new m({el:document.createElement("div"),propsData:i}),document.body.appendChild(e.$el),g[i.name]=e,new Promise(function(t,n){e.open().then(function(n){e.$el.parentNode.removeChild(e.$el),e.$destroy(),delete g[i.name],t(n)})})}function n(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=void 0,i=_.assign({name:Math.round(1e3*Math.random()),message:"",title:"消息",width:400,height:200,background:"white",titleHeight:60,bottomHeight:60,borderRadius:8,buttons:[{cls:"sure",cmd:"sure",txt:"确认"},{cls:"cancel",cmd:"cancel",txt:"取消"}]},_.isPlainObject(t)?t:{message:t});return e=new m({el:document.createElement("div"),propsData:i}),document.body.appendChild(e.$el),g[i.name]=e,new Promise(function(t,n){e.open().then(function(n){e.$el.parentNode.removeChild(e.$el),e.$destroy(),delete g[i.name],t(n)})})}var s={zIndex:5e3,masks:[],mask:null,setDom:function(){this.mask||(this.mask=document.createElement("div"),this.mask.className="vue-mask"),null==document.querySelector(".vue-mask")&&document.body.appendChild(this.mask),this.mask.style.zIndex=this.zIndex+2*this.masks.length-1},setIndex:function(t,e){t.style&&(t.style.zIndex=this.zIndex+2*this.masks.length-(e?1:0))},create:function(t){this.setDom(),this.masks.push(t._uid),this.setIndex(this.mask,!0),this.setIndex(t.$el)},remove:function(t){this.masks.splice(_.chain(this.masks).findIndex(function(t){return t.id===t._uid}).value(),1),0!==this.masks.length?this.setIndex(this.mask,!0):this.mask.parentNode.removeChild(this.mask)}},o={data:function(){return{visible:!1,zIndex:0}},beforeDestroy:function(){this.$emit("beforeDestroy")},methods:{open:function(){var t=this;return new Promise(function(e,i){var n=function(){t.visible=!0,t.resolve=e,t.reject=i,s.create(t),t.afterOpen&&t.afterOpen()};t.beforeOpen?t.beforeOpen().then(n):n()})},close:function(t){var e=this,i=function(){e.visible=!1,s.remove(e);var i=function(){e.resolve(t)};e.afterClose?e.afterClose().then(i):i()};this.beforeClose?this.beforeClose().then(i):i()}}},a=!1,d="ontouchstart"in window,r=function(t,e){var i=function(t){e.drag&&e.drag(d?t.changedTouches[0]||t.touches[0]:t)},n=function t(n){d||(document.removeEventListener("mousemove",i),document.removeEventListener("mouseup",t)),document.onselectstart=null,document.ondragstart=null,a=!1,e.end&&e.end(d?n.changedTouches[0]||n.touches[0]:n)};t.addEventListener(d?"touchstart":"mousedown",function(t){a||(document.onselectstart=function(){return!1},document.ondragstart=function(){return!1},d||(document.addEventListener("mousemove",i),document.addEventListener("mouseup",n)),a=!0,e.start&&(t.preventDefault(),!1===e.start(d?t.changedTouches[0]||t.touches[0]:t)&&(a=!1,d||(document.removeEventListener("mousemove",i),document.removeEventListener("mouseup",n)),document.onselectstart=null,document.ondragstart=null)))}),d&&(t.addEventListener("touchmove",i),t.addEventListener("touchend",n),t.addEventListener("touchcancel",n))},h={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"vue-modal"},[i("div",{staticClass:"vue-modal-container",style:t.styleContainer},[i("div",{staticClass:"vue-modal-content-background",style:t.contentBackground},[i("div",{ref:"title",staticClass:"vue-modal-title",style:t.styleTitle},[t._v("\n        "+t._s(t.title)+"\n        "),i("a",{style:t.styleTitleClose,attrs:{href:"javascript:;"},on:{click:t.close}})]),t._v(" "),i("div",{directives:[{name:"show",rawName:"v-show",value:t.moving,expression:"moving"}],staticClass:"vue-modal-status",style:t.styleContent},[i("svg",{staticClass:"icon",attrs:{t:"1493353365923",viewBox:"0 0 1025 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"5966","xmlns:xlink":"http://www.w3.org/1999/xlink",height:"20%",fill:"rgba(0,0,0,.1)"}},[i("defs"),t._v(" "),i("path",{attrs:{d:"M507.723027 639.47369C576.326639 639.47369 638.176327 582.659169 638.176327 512.574903 638.176327 442.490637 576.326639 385.676112 507.723027 385.676112 439.119415 385.676112 383.505198 442.490635 383.505198 512.574901 383.505198 582.659166 439.119415 639.47369 507.723027 639.47369Z","p-id":"5967"}}),t._v(" "),i("path",{attrs:{d:"M333.10379 257.010049C320.464977 242.392432 318.039349 213.583993 330.933492 198.647214L482.381569 11.362984C495.339544-3.637628 516.021238-3.829125 528.91538 11.043822L690.840233 199.413203C703.734375 214.03082 703.734375 242.137102 690.840233 257.010049L333.10379 257.010049Z","p-id":"5968"}}),t._v(" "),i("path",{attrs:{d:"M691.23233 771.300256C703.998808 782.024097 703.871143 804.480415 691.23233 815.204256L531.213346 1013.339991C518.255371 1024 497.701342 1024 484.934864 1013.339991L333.955618 815.204256C321.18914 804.480415 321.18914 782.151762 333.955618 771.427921L691.23233 771.300256Z","p-id":"5969"}}),t._v(" "),i("path",{attrs:{d:"M825.863653 338.950803 1013.147882 486.148292C1028.084661 499.553093 1028.33999 521.319938 1013.530876 534.660907L825.352994 688.560797C810.799209 701.774101 783.580025 702.029431 768.770911 688.560797L768.770911 338.567816C768.770911 338.567816 810.990706 325.546001 825.863653 338.950803Z","p-id":"5970"}}),t._v(" "),i("path",{attrs:{d:"M256.661324 691.369415C242.043707 704.710385 212.753558 704.582726 198.135941 691.369422L10.979377 534.405578C-3.702072 520.936944-3.702072 499.361596 11.234707 485.892962L196.859294 335.440022C211.476911 322.226717 241.979878 322.099048 256.661328 335.440017L256.661324 691.369415Z","p-id":"5971"}})])]),t._v(" "),""!=t.src?i("div",{directives:[{name:"show",rawName:"v-show",value:!t.moving,expression:"!moving"}],ref:"contentIframe",staticClass:"vue-modal-content",style:t.styleContent},[i("iframe",{style:t.iframeStyle,attrs:{src:t.src,frameborder:"0"}})],1):t._e(),t._v(" "),""==t.src?i("div",{directives:[{name:"show",rawName:"v-show",value:!t.moving,expression:"!moving"}],ref:"contentElement",staticClass:"vue-modal-content content-element",style:t.styleContent},[t._t("default")],2):t._e()])]),t._v(" "),i("div",{staticClass:"vue-modal-background"})])},staticRenderFns:[],mixins:[o],data:function(){return{distance:10,offsetLeft:0,offsetTop:0,baseWidth:50,baseHeight:50,screenWidth:0,screenHeight:0,closeIconMinSize:20,moving:!1,moveOffset:{x:0,y:0},defaultWidth:0,defaultHeight:0}},props:{title:String,width:Number,height:Number,padding:{type:Object,default:function(){return{top:0,right:0,bottom:0,left:0}}},borderRadius:{type:Number,default:8},draggable:{type:Boolean,default:!0},offset:{type:Object,default:function(){return{left:0,top:0}}},titleHeight:{type:Number,default:60},titleAlign:{type:String,default:"left"},closeIconSize:{type:Number,default:20},background:{default:"white",type:String},backgroundImage:{default:"white",type:String},src:{default:"about:blank;",type:String}},created:function(){this.closeIconSize=this.closeIconSize<this.closeIconMinSize?this.closeIconSize:this.closeIconMinSize,this.defaultWidth=this.width,this.defaultHeight=this.height},mounted:function(){var t=this;this.draggable&&this.$nextTick(function(){return t.bindMove(t.$refs.title)}),this.resizeEvt="orientationchange"in window?"orientationchange":"resize",this.svgResizeHandler=this.svgResize.bind(this),window.addEventListener(this.resizeEvt,this.svgResizeHandler,!1)},beforeDestroy:function(){window.removeEventListener(this.resizeEvt,this.svgResizeHandler)},computed:{styleTitleClose:function(){var t=this.closeIconSize,e=(this.titleHeight-this.closeIconSize)/2;return{height:t+"px",width:t+"px",top:e+"px",right:e+"px"}},contentBackground:function(){return{backgroundImage:this.backgroundImage}},iframeStyle:function(){return{width:this.width-this.offset.left-this.padding.left-this.padding.right+"px",height:this.height-this.titleHeight-this.offset.top-this.padding.top-this.padding.bottom+"px",marginLeft:this.offset.left+"px",marginTop:this.offset.top+"px"}},styleTitle:function(){return{height:this.titleHeight+"px",paddingRight:this.titleHeight+"px",lineHeight:this.titleHeight+"px",textAlign:this.titleAlign,paddingLeft:("center"===this.titleAlign?this.titleHeight:30)+"px"}},styleContent:function(){return{height:this.height-this.titleHeight-this.padding.top-this.padding.bottom+"px",width:this.width-this.padding.left-this.padding.right+"px"}},styleContainer:function(){return{height:this.height+"px",width:this.width+"px",marginLeft:-this.width/2+this.moveOffset.x+"px",marginTop:-this.height/2+this.moveOffset.y-this.topOffset+"px",paddingTop:this.padding.top+"px",paddingRight:this.padding.right+"px",paddingBottom:this.padding.bottom+"px",paddingLeft:this.padding.left+"px"}},runtimeWidth:function(){return this.width},runtimeHeight:function(){return this.height},topOffset:function(){var t=.1*this.screenHeight;return(this.screenHeight-this.height)/2-t<0?0:t}},methods:{gPath:function(t,e,i,n){var s=(t-2*this.borderRadius)/3,o=(e-2*this.borderRadius)/3,a=i?0:(n?-1:1)*this.distance,d=-1*a;return"M"+(this.screenWidth-t)/2+" "+((this.screenHeight-e)/2-this.topOffset+this.borderRadius)+"q0,"+-this.borderRadius+" "+this.borderRadius+","+-this.borderRadius+"c"+s+","+a+" "+2*s+","+a+" "+3*s+",0q"+this.borderRadius+",0 "+this.borderRadius+","+this.borderRadius+"c"+d+","+o+", "+d+","+2*o+" ,0,"+3*o+"q0,"+this.borderRadius+" "+-this.borderRadius+","+this.borderRadius+"c-"+s+","+d+" -"+2*s+","+d+" -"+3*s+",0q"+-this.borderRadius+",0 "+-this.borderRadius+","+-this.borderRadius+"c"+a+",-"+o+" "+a+",-"+2*o+", 0,-"+3*o},svgResize:function(){var t=this.$el.querySelector(".vue-modal-background");t.offsetWidth<=this.defaultWidth||t.offsetHeight<=this.defaultHeight?(t.offsetWidth<=this.defaultWidth?this.width=t.offsetWidth:this.width=this.defaultWidth,t.offsetHeight<=this.defaultHeight?this.height=t.offsetHeight:this.height=this.defaultHeight):(this.width=this.defaultWidth,this.height=this.defaultHeight),this.screenWidth=t.offsetWidth,this.screenHeight=t.offsetHeight,this.svg.attr("width",this.screenWidth).attr("height",this.screenHeight),this.path.attr("d",this.gPath(this.runtimeWidth,this.runtimeHeight,!0))},svgAnimateStart:function(){var t=this,e=this.$el.querySelector(".vue-modal-background");this.screenWidth=e.offsetWidth,this.screenHeight=e.offsetHeight,this.svg=window.d3.select(e).append("svg").attr("width",this.screenWidth).attr("height",this.screenHeight),this.g=this.svg.append("g"),this.path=this.g.append("path"),this.path.attr("fill",this.background).attr("d",this.gPath(this.baseWidth,this.baseHeight,!0)).style("opacity","0").transition().duration(100).attr("d",this.gPath(this.baseWidth,this.baseHeight,!1,!1)).transition().delay(100).duration(200).ease(window.d3.easeExpIn).style("opacity","1").attr("d",this.gPath(this.runtimeWidth,this.runtimeHeight,!0)),setTimeout(function(){t.$el.className="vue-modal is-show"},400)},svgAnimateEnd:function(){var t=this;return new Promise(function(e,i){t.path.attr("d",t.gPath(t.runtimeWidth,t.runtimeHeight,!0)).transition().duration(100).attr("d",t.gPath(t.runtimeWidth,t.runtimeHeight,!1,!0)).transition().delay(100).duration(200).ease(window.d3.easeExpOut).style("opacity","0").attr("d",t.gPath(t.baseWidth,t.baseHeight,!0)),setTimeout(function(){e()},300)})},translateSVG:function(){this.g.attr("transform","translate("+this.moveOffset.x+","+this.moveOffset.y+")")},afterOpen:function(){return this.svgAnimateStart()},beforeClose:function(){return this.$el.className="vue-modal",this.svgAnimateEnd()},bindMove:function(t){var e,i,n,s,o,a,d,h,l,u=this;t&&r(t,{start:function(t){l=0,n=u.moveOffset.x,s=u.moveOffset.y,e=t.pageX-n,i=t.pageY-s,o=(document.documentElement.offsetWidth-u.width)/2,a=(document.documentElement.offsetHeight-u.height)/2,d=-1*o,h=-1*a},drag:function(t){l>1?(u.moving=!0,t.pageX-e<d?u.moveOffset.x=d:t.pageX-e>o?u.moveOffset.x=o:u.moveOffset.x=t.pageX-e,t.pageY-i<h?u.moveOffset.y=h:t.pageY-i>a?u.moveOffset.y=a:u.moveOffset.y=t.pageY-i,u.translateSVG()):l++},end:function(){u.moving=!1}})}}},l=Vue.extend(h),u={},c=t,f={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("modal",{ref:"modal",attrs:{title:t.title,borderRadius:t.borderRadius,titleHeight:t.titleHeight,background:t.background,width:t.width,height:t.height,src:""}},[i("div",{staticClass:"vue-alert"},[i("div",{staticClass:"vue-alert-message",style:t.messageStyle},[i("table",[i("tr",[i("td",[t._v(t._s(t.message))])])])]),t._v(" "),i("div",{staticClass:"vue-alert-button-panel",style:t.buttonPanelStyle},t._l(t.buttons,function(e){return i("button",{class:e.cls,domProps:{textContent:t._s(e.txt)},on:{click:function(i){t.close(e.cmd)}}})}))])])},staticRenderFns:[],components:{modal:h},props:{title:String,background:{type:String,default:"white"},width:{type:Number,default:400},height:{type:Number,default:200},borderRadius:{type:Number,default:8},titleHeight:{type:Number,default:60},bottomHeight:{type:Number,default:60},message:{type:String,default:"无消息!"},buttons:{type:Array,default:function(){return[{cls:"sure",cmd:"sure",txt:"确认"}]}}},computed:{messageStyle:function(){return{height:this.height-this.titleHeight-this.bottomHeight+"px"}},buttonPanelStyle:function(){return{height:this.bottomHeight+"px",lineHeight:this.bottomHeight+"px"}}},methods:{open:function(){return this.$refs.modal.open()},close:function(t){this.$refs.modal.close(t)}}},m=Vue.extend(f),g={};return{modal:c,close:e,alert:i,confirm:n}});
//# sourceMappingURL=components.js.map
